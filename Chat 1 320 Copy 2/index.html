<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chat 1 320 copy 2</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width">
</head>
<body>
    
    <div class="chat">
       
        <header class="chat-header">
            <div class="user-picture"></div>
            <div class="user-name">Наталья Лемясова</div>
            <a href="" class="button-close"><img src="close.svg" alt="закрыть"></a>
        </header>
        
            <form action="get" id="sms-confirm-form" class="sms-confirm-form" name="smsConfirmForm">
               
                <div class="sms-confirm-header">Подтверждение телефона</div>
                <label for="sms-confirm-code" class="sms-confirm-code">Введите код, отправленный на номер<br><span class="sms-confirm-number">+7 (903) 003-77-77</span> <a href="#" class="change-number">Изменить</a></label>
                <div class="input-wrapper">
                    <input id="sms-confirm-code" class="sms-confirm-code-input" type="number" pattern="\d*" maxlength="1" placeholder="-" name="firstNumber" required max="9" min="0" oninput="handleUserInput(this, document.smsConfirmForm.secondNumber)">
                    <input id="sms-confirm-code" class="sms-confirm-code-input" type="number" pattern="\d*" maxlength="1" placeholder="-" name="secondNumber" required max="9" min="0" oninput="handleUserInput(this, document.smsConfirmForm.thirdNumber, document.smsConfirmForm.firstNumber)">
                    <input id="sms-confirm-code" class="sms-confirm-code-input" type="number" pattern="\d*" maxlength="1" placeholder="-" name="thirdNumber" required max="9" min="0" oninput="handleUserInput(this, document.smsConfirmForm.fourthNumber, document.smsConfirmForm.secondNumber)">
                    <input id="sms-confirm-code" class="sms-confirm-code-input" type="number" pattern="\d*" maxlength="1" placeholder="-" name="fourthNumber" required max="9" min="0" oninput="handleUserInput(this, false, document.smsConfirmForm.thirdNumber)">
                </div>
                
                <div class="no-code-recieved">Не приходит код? Отправим снова через&nbsp;<span id="countdown">59</span>&nbsp;сек.</div>
                
                <a href="#" class="sms-confirm-cancel">Отменить</a>
            </form>
        
    </div>
    
    <script>
        window.addEventListener("keydown", function(event) {
            const key = Number(event.key)
            const keyCodes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
            if (!window.wasKeyPressed && keyCodes.includes(key)) {
                const firstInputField = document.smsConfirmForm.firstNumber
                firstInputField.focus()
                window.wasKeyPressed = true
            }
        })

        window.addEventListener("keyup", function(event) {
            if (event.key === 'Backspace') {
                if (document.activeElement.name !== 'firstNumber') {
                    document.activeElement.previousElementSibling.focus()
                }
            }
        })
        function autoTab(current,to) {
            if (current.getAttribute && current.value.length == current.getAttribute("maxlength")) {
                to.focus();
            }
        }
        function handleUserInput(that, nextElement, prevElement) {
            console.warn({that, nextElement, prevElement})
            if (nextElement) {
                autoTab(that, nextElement);
            }
            if (that.value.length > that.maxLength) { 
                that.value = that.value.slice(0, that.maxLength);
            }
        }
    </script>
</body>
</html>